#!/bin/bash

START_PATH="/home/emullen/Dropbox/grad_cs/501/start"
REPO_PATH="/home/emullen/Dropbox/grad_cs/501/cse_501"
HW="hw2"

FILE=$1

IR=${FILE%.*}.sir

OPT=${FILE%.*}.opt

#grab and compile to IR
dart $START_PATH/bin/start.dart -c $FILE > $IR

#get rid of the output file
#-f for silent (doesn't complain when file not there)
rm -f $OPT

#run our script to optimize the IR
scala -classpath $REPO_PATH/$HW/code main $IR $OPT

#run the IR
dart $START_PATH/bin/start.dart -r $OPT
